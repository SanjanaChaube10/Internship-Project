{% extends "accounts/base.html" %}
{% load static %}
{% block title %}Insights / Analytics{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/admin_analytics.css' %}">

<section class="ana-wrap">
  <div class="ana-container">
    <h1 class="ana-page-title">Insights / Analytics{% if college %} — {{ college.name }}{% endif %}</h1>

    <article class="ana-card">
      <div class="table-responsive">
        <table class="ana-table">
          <thead>
            <tr>
              <th>Event ID</th>
              <th>Title</th>
              <th>UGC</th>
              <th>Reviews</th>
              <th>Avg Rating</th>
              <th>Views</th>
              <th>Shares</th>
              <th>Engagement</th>
              <th>Popular Event</th>
              <th>Last Activity</th>
              <th>Recent User</th>
            </tr>
          </thead>
          <tbody>
            {% for r in rows %}
              <tr>
                <td class="mono">{{ r.event.event_id }}</td>
                <td>{{ r.event.title }}</td>
                <td>{{ r.ugc_count }}</td>
                <td>{{ r.reviews_count }}</td>
                <td>★ {{ r.avg_rating }}</td>
                <td>{{ r.analytics.views }}</td>
                <td>{{ r.analytics.shares }}</td>
                <td class="bold">{{ r.analytics.engagement_score }}</td>
                <td>{% if r.is_popular or r.analytics.popular_event == "yes" %}Yes{% else %}No{% endif %}</td>
                <td>{% if r.last_activity %}{{ r.last_activity|date:"M d, Y" }}{% else %}—{% endif %}</td>
                <td>
                  {% if r.recent_user %}
                    {{ r.recent_user.user_id }} — {{ r.recent_user.username }}
                  {% else %}
                    —
                  {% endif %}
                </td>
              </tr>
            {% empty %}
              <tr><td colspan="10" class="empty">No data yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </article>
  </div>
</section>
{% endblock %}