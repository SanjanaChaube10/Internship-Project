{% extends "accounts/base.html" %}
{% load static %}
{% block title %}My UGC{% endblock %}

{% block content %}
<section class="ud-wrap">
  <div class="container">
    <h1 class="ud-page-title">My UGC</h1>

    {% if items %}
      <ul class="ud-list">
        {% for u in items %}
          <li class="ugc-item">
            <div class="ugc-meta">
              <strong>{{ u.content_type|title }}</strong>
              <span class="ud-muted"> ¬∑ {{ u.posted_on|date:"M d, Y" }}</span>
            </div>

            <div class="ugc-caption">{{ u.content_data|default:"(no caption)" }}</div>

            {# render photos if any #}
            {% with photos=u.photos.all %}
              {% if photos %}
                <div class="ugc-photos">
                  {% for p in photos %}
                    <img src="{{ p.image_url }}" alt="Photo" class="ugc-photo">
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            <div class="ud-note">
              Event: {{ u.event.title }} ({{ u.event.event_id }}) ‚Äî
              <a href="{% url 'ugc:event_hub' u.event.event_id %}">Share &amp; Review for this event</a>
            </div>

            {# üóë Delete button #}
            <form method="post" 
                  action="{% url 'ugc:delete_ugc' u.ugc_id %}" 
                  onsubmit="return confirm('Delete this post? This cannot be undone.');">
              {% csrf_token %}
              <button type="submit" class="ud-btn-danger">Delete</button>
            </form>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="ud-muted">You haven‚Äôt uploaded anything yet.</p>
      <p>
        Go to <a href="{% url 'events:events_page' %}">Events</a> and open an event‚Äôs
        ‚ÄúShare &amp; Review‚Äù page to post UGC.
      </p>
    {% endif %}
  </div>
</section>

<style>
.ugc-photos { margin-top: 8px; display: flex; gap: 10px; flex-wrap: wrap; }
.ugc-photo { max-width: 240px; height: auto; border-radius: 10px; box-shadow: 0 4px 14px rgba(0,0,0,.08); }
.ugc-caption { margin-top: 4px; }
.ud-btn-danger {
  background: #e63946;
  color: #fff;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  margin-top: 8px;
}
.ud-btn-danger:hover {
  background: #c71c2c;
}
</style>

{% endblock %}